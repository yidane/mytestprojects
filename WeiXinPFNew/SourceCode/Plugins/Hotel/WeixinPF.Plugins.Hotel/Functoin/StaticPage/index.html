<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-validate="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>在线预订</title>
    <meta name="viewport"
          content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <!--    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.5.8/css/sm.min.css">-->
    <!--<link href="../../Common/CSS/weui/weui.min.css" rel="stylesheet"/>-->
    <link href="../../Common/web_component/swiper/swiper.min.css" rel="stylesheet"/>


    <link href="CSS/hotels.css" rel="stylesheet"/>
    <style>
        .fade-transition {
            transition: opacity .3s ease;
        }

        .fade-enter, .fade-leave {
            opacity: 0;
        }


    </style>
</head>
<!-- index.html -->
<body>
<div id="div_app" class="content-padded" style="    padding-bottom: 60px;
    padding-top: 60px;">


    <app-header :header-title="headerTitle"></app-header>

    <app-image :view-images="imgDatas"></app-image>


    <component :is="currentView" keep-alive transition="fade"
               transition-mode="out-in" :current-view="currentView"
               :wid="wid" :openid="openid" :hotel="hotel" :room="room" :order="order">
        <!-- 组件在 vm.currentview 变化时改变 -->
    </component>
    <app-footer :current-view="currentView" :order-count="orderCount"
:wid="wid" :openid="openid" :hotel="hotel"
    ></app-footer>
</div>


<!-- 子组件模板 -->
<template id="app-header-template">
    <div class="menu_header">
        <div class="menu_topbar">
            <strong class="head-title">{{headerTitle}}</strong>
            <span class="head_btn_left"><a href="javascript:history.go(-1);"><span>返回</span></a><b></b></span>
            <a class="head_btn_right" href="http://www.cloudorg.com.cn/weixin/map/poilist.html?type=hotel&wid=1">
                <span><i class="menu_header_home"></i></span><b></b>
            </a>
        </div>
    </div>

    <!--<header class="bar bar-nav">-->
    <!--<a class="button button-link button-nav pull-left" href="javascript:history.go(-1);">-->
    <!--<span class="icon icon-left"></span>-->
    <!--返回-->
    <!--</a>-->
    <!--<a class="button button-link button-nav pull-right" href="http://www.cloudorg.com.cn/weixin/map/poilist.html?type=hotel&wid=1">-->
    <!--<span class="icon icon-home"></span>-->
    <!--</a>-->
    <!--<h1 class="title">{{headerTitle}}</h1>-->
    <!--</header>-->
</template>

<template id="app-footer-template">


    <div class="footermenu">

        <ul>
            <li>
                <a id="about" href="#about"
                   :class="{ active: currentView=='view-about' }"

                  :href="'#/about'+'/'+wid+'/'+hotel.id+'/'+openid"
                        >
                    <img src="images/xxyX63YryG.png">

                    <p>关于</p>
                </a>
            </li>
            <li>
                <a id="choice" href="#room"
                   :class="{ active: currentView=='view-room' }"

  :href="'#/room'+'/'+wid+'/'+hotel.id+'/'+openid"
                        >
                    <img src="images/3YQLfzfunJ.png">

                    <p>房型选择</p>
                </a>
            </li>
            <li>
                <a id="myOrder" href="#order"
                   :class="{ active: currentView=='view-order'||currentView=='view-orderCreate' }"
                  :href="'#/order'+'/'+wid+'/'+hotel.id+'/'+openid"
                        >
                    <span class="num">{{orderCount}}</span> <img src="images/s22KaR0Wtc.png">

                    <p>订单</p>
                </a>
            </li>
        </ul>
    </div>


    <!--<nav class="bar bar-tab">-->
    <!--<a class="tab-item external" href="#">-->
    <!--<span class="icon icon-cart"></span>-->
    <!--<span class="tab-label">关于</span>-->
    <!--</a>-->
    <!--<a class="tab-item external active" href="#">-->
    <!--<span class="icon icon-home"></span>-->
    <!--<span class="tab-label">房型选择</span>-->

    <!--</a>-->
    <!--<a class="tab-item external" href="#">-->
    <!--<span class="icon icon-cart"></span>-->
    <!--<span class="tab-label">订单</span>-->
    <!--<span class="badge">0</span>-->
    <!--</a>-->

    <!--</nav>-->
</template>

<template id="view-image-template">
    <style>
        .header-img {
            width: 100%;
            height: 200px;
        }

        .swiper-container {
            width: 100%;
            height: 200px;
        }
    </style>

    <div class="swiper-container">
        <div class="swiper-wrapper">

            <div class="swiper-slide" v-for="imgData in viewImages">

                <img class="header-img" :src="imgData.img">
            </div>
        </div>
        <!-- 如果需要分页器 -->
        <div class="swiper-pagination"></div>

        <!-- 如果需要导航按钮 -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>



</template>

<template id="view-about-template">
    <style>
        .jieshao {
            color: #444444;
            font-family: 'Microsoft YaHei', Helvitica, Verdana, Arial, san-serif;
            font-size: 14px;
            font-weight: bold;
            line-height: 21px;
            background-color: #FCFCFC;
        }
    </style>

    <div class="cardexplain">


        <ul class="round">
            <li class="addr">
                <a href="/weixin/map/map_address.html?type=hotel&id={{hotel.id}}"><span>{{hotel.address}}</span></a>
            </li>
            <li class="tel"><a href="tel:{{hotel.tel}}"><span>{{hotel.tel}} 电话预订</span></a></li>
        </ul>
        <div class="detailcontent">
            <h2>商家介绍</h2>

            <div class="content">
                <span class="jieshao">{{hotel.jieShao}}</span>
            </div>
        </div>
    </div>

</template>

<template id="view-room-template">
    <!--商家房价及类型-->
    <ul class="round">
        <li class="title"><span class="none">{{hotel.name}}</span></li>
        <li class="dandanb" v-for="room in rooms">

            <a :href="'#/order'+'/0/'+wid+'/'+hotel.id+'/'+openid" v-on:click="viewOrderCreate(room)" >
                <span>
                    <table class="jiagebiao" width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tbody>
                        <tr>
                            <td>
                                <div>{{room.roomType}}</div>
                                <div><img :src="room.RoomPictures[0].url" class="showimg">

                                    <p class="break-word">{{room.detail}}</p>

                                    <p>原价：<a class="yuanjia">￥{{room.costPrice}}</a></p>

                                    <p>优惠价：<a class="youhuijia">￥{{room.totalPrice}}</a></p></div>
                            </td>
                        </tr>
                        </tbody>
                    </table> </span></a></li>
    </ul>

    <ul class="round">
        <li class="addr">
            <a href="/weixin/map/map_address.html?type=hotel&id={{hotel.id}}"><span>{{hotel.address}}</span></a>
        </li>
        <li class="tel"><a href="tel:{{hotel.tel}}"><span>{{hotel.tel}} 电话预订</span></a></li>
        <li class="detail"><a href="hotel_detail.aspx?openid={{openid}}&hotelid={{hotel.id}}&wid={{wid}}"><span>查看商家详情</span></a>
        </li>
    </ul>
    </div>

</template>

<template id="view-order-template">


    <div class="cardexplain">

        <!--超过预订时间3天后自动删掉预订记录，免得占服务器资源！-->
        <ul class="round" v-for="order in orders">
            <li class="title">
                <a :href="'#/order'+'/'+ order.id +'/'+wid+'/'+hotel.id+'/'+openid" v-on:click="viewOrderCreate(order)">
                <span><b>{{order.orderTime}}</b>
                    <b style='margin-left:0.5rem'>{{hotel.name}}</b></span></a>
            </li>
            <table width="100%" border="0" cellpadding="0" cellspacing="0" class="cpbiaoge">
                <tbody>
                <tr>
                    <th>订单编号</th>
                    <th width="70" class="cc">订单金额</th>
                    <th width="60" class="cc">订单状态</th>
                </tr>
                <tr>
                    <td>{{order.orderNumber}}</td>
                    <td class="cc">{{order.orderPrice}}</td>
                    <td class="cc"><em class="ok">{{order.statusName}}</em></td>
                </tr>
                </tbody>
            </table>
        </ul>
    </div>
</template>

<template id="view-orderCreate-template">
    <style>
        .full-btn{
            width: 100%;
        }
    </style>


    <ul class="round">
        <li class="biaotou bradius pad">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td>类型</td>
                    <td class="yuanjia">原价</td>
                    <td class="youhuijia">优惠价</td>
                </tr>
            </table>
        </li>
        <li><span class="noneorder">
                <table class="jiagebiao" width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td>{{room.roomType}}</td>
                        <td class="yuanjia">￥{{room.costPrice}}</td>
                        <td class="youhuijia">￥{{room.totalPrice}}</td>
                    </tr>
                </table>
            </span>
        </li>

    </ul>

    <!--后台可控制是否显示-->


    <div class="detailcontent">
        <h2 class="gpd-item-title">
            <img class="detailicon-ticket" src="www.cloudorg.com.cn/weixin/restaurant/images/info.png" />
            <span class="gpd-item-title-name">商品说明</span>
            <span class="gp-icons gpd-up-icon"></span>
        </h2>
        <div class="content  gpd-content">{{room.detail}} </div>
    </div>

    <div class="detailcontent">
        <h2 class="gpd-item-title">
            <img class="detailicon-ticket" src="www.cloudorg.com.cn/weixin/restaurant/images/info.png" />
            <span class="gpd-item-title-name">使用须知</span>
            <span class="gp-icons gpd-up-icon"></span>

        </h2>

        <div class="content gpd-content">
            {{room.instruction}}

        </div>
    </div>


    <div class="detailcontent">
        <h2 class="gpd-item-title">
            <img class="detailicon-ticket" src="www.cloudorg.com.cn/weixin/restaurant/images/undo.png" />
            <span class="gpd-item-title-name">退单规则</span>
            <span class="gp-icons gpd-up-icon"></span>

        </h2>

        <div class="content gpd-content">

            {{room.refundRule}}
        </div>
    </div>


    <ul class="round">
        <li class="tel"><a href="tel: {{hotel.tel}}"><span>{{hotel.tel}} 电话预订</span></a></li>
    </ul>





    <div class='alert alert-warning' role='alert'>
        <strong>提示</strong> 填写入住其中一人的真实信息即可。
    </div>
    <div class="footer-money">

        <p>
            <span class=" color-red">已优惠</span>
            <span id="price3" class="color-red discount-money">￥{{discount}}</span>
            <span>共</span>
            <span id="price" class="  total-money color-red">￥{{totalPrice}}</span>
            <span id="yuanjia" class="  cost-money">￥{{costPrice}}</span>

        </p>

    </div>


    <validator lazy name="roomValidation">
        <form novalidate @submit.prevent="onSubmit">

            <ul class="round">
                <li class="title mb"><span class="none">请认真填写在线订单</span></li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>预订人</th>
                            <td>
                                <input name="oderName" type="text" class="px" id="oderName"
                                       v-validate:oderName="['required']" v-model="order.orderUser.userName"
                                       placeholder="请输入您的真实姓名" /></td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>身份证号</th>
                            <td>
                                <input name="identityNumber" type="text" class="px"
                                       v-validate:identityNumber="{  required: { rule: true, message: '该项为必填项' }
                                       , idcard: { rule: true, message: '请输入正确的身份证号' } }"
                                       id="identityNumber" v-model="order.orderUser.userIdcard"
                                       placeholder="请输入您的身份证号" /></td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>联系电话</th>
                            <td>
                                <input name="tel" type="tel" class="px" id="tel"
                                       v-validate:identityNumber="{  required: { rule: true, message: '该项为必填项' }
                                       , mobile: { rule: true, message: '请输入正确的手机号' } }"
                                       v-model="order.orderUser.userMobile" required placeholder="请输入您的手机号" /></td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>入住时间</th>
                            <td>
                                <input name="arriveTime" class="px min-today"
                                       id="arriveTime"
                                       :min="today"
                                       v-validate:arriveTime="{  required: { rule: true, message: '该项为必填项' }}"
                                       v-model="order.arriveTime"
                                       type="date" placeholder="入住时间" />
                            </td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>离店时间</th>
                            <td>
                                <input name="leaveTime" class="px min-today" id="leaveTime"
                                       :min="minLeaveDate"
                                       v-validate:leaveTime="{  required: { rule: true, message: '该项为必填项' }}"
                                       v-model="order.leaveTime"
                                       type="date" placeholder="离店时间" />
                            </td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>类型</th>
                            <td class="userinfo">{{room.roomType}}</td>

                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>预订数量</th>
                            <td>
                                <select name="orderNum" class="dropdown-select" id="orderNum"
                                        v-validate:orderNum="{  required: { rule: true, message: '该项为必填项' }}"
                                        v-model="order.orderNum">
                                    <option v-for="n in 20" :value="n+1">{{n+1}}</option>

                                </select></td>
                        </tr>
                    </table>
                </li>
                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th>单价</th>
                            <td class="userinfo price">￥{{room.totalPrice}}</td>
                        </tr>
                    </table>
                </li>




                <li class="nob">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="kuang">
                        <tr>
                            <th valign="middle" class="thtop">备注</th>
                            <td>
                                <textarea name="remark" class="pxtextarea"
                                          style="height: 99px; overflow-y: visible"
                                          v-model="order.remark"
                                          id="remark" placeholder="请输入备注信息"></textarea></td>
                        </tr>
                    </table>
                </li>
            </ul>
            <!--<div>-->
            <!--<span v-if="$roomValidation.id.required">Required Your ID.</span>-->
            <!--<span v-if="$validation.id.minlength">Your ID is too short.</span>-->
            <!--<span v-if="$validation.id.maxlength">Your ID is too long.</span>-->
            <!--</div>-->
            <div class="footReturn" style="margin-bottom: 50px;">
                <li class="footerbtn" v-if="order.status==0||order.status==2">
                    <input  class="del right3"
                           type="button" value="取消订单"  > </li>
                <li :class="[order.status==-1?'full-btn':'footerbtn']" >
                    <input id="showcard" class="submit" style="width: 100%"
                           type="submit" value="提交订单" v-if="$roomValidation.valid">
                </li>



            </div>


        </form>
    </validator>


</template>

<script src="../../Common/JS/zepto.min.js"></script>
<!--<script type='text/javascript' src='//g.alicdn.com/sj/lib/zepto/zepto.min.js' charset='utf-8'></script>-->
<!--<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.5.8/js/sm.min.js' charset='utf-8'></script>-->
<!--<script src="http://cdn.jsdelivr.net/vue/1.0.13/vue.min.js"></script>-->
<script src="../../Common/JS/vue/vue.min.js"></script>
<!--<script src="https://cdn.jsdelivr.net/vue.router/0.5.2/vue-router.min.js"></script>-->
<script src="../../Common/JS/vue/vue-resource.min.js"></script>
<script src="https://cdn.jsdelivr.net/vue.validator/2.0.0-alpha.8/vue-validator.min.js"></script>
<!-- <script src="../../Common/JS/vue/vue-validator.min.js"></script> -->
<script src="../../Common/web_component/swiper/swiper.min.js"></script>
<script src="https://rawgit.com/flatiron/director/master/build/director.min.js">
   </script>

<script>
    //根据QueryString参数名称获取值

    function getQueryStringByName(name) {

        var result = location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));

        if (result == null || result.length < 1) {

            return "";

        }

        return result[1];

    }
</script>
<script src="JS/index/v-index-appFooter.js"></script>
<script src="JS/index/v-index-viewAbout.js"></script>
<script src="JS/index/v-index-viewOrder.js"></script>
<script src="JS/index/v-index-viewRoom.js"></script>
<script src="JS/index/v-index-viewOrderCreate.js"></script>
<script src="JS/index/main.js"></script>



</body>
</html>
